# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @name correlationCoefficient
#' @aliases correlationCoefficient,FastWilcoxTest-method
#' @rdname correlationCoefficient-methods
#' @docType methods
#' @description simply calculate the correlation between X and Y
#' @param X one numeric vector
#' @param Y the correlating vector
#' @title Calculate correlation over two double vectors
#' @export
correlationCoefficient <- function(X, Y) {
    .Call(`_FastWilcoxTest_correlationCoefficient`, X, Y)
}

#' @name CorMatrixIDS
#' @aliases CorMatrixIDS,FastWilcoxTest-method
#' @rdname CorMatrixIDS-methods
#' @docType methods
#' @description simply calculate the correlation between X and Y (slower than apply cor)
#' @param X the sparse matrix
#' @param CMP the vector to correlate every column of the matrix to
#' @param ids the rows of the matrix to correlate to
#' @title Calculate correlation over two double vectors
#' @export
CorMatrixIDS <- function(X, CMP, ids) {
    .Call(`_FastWilcoxTest_CorMatrixIDS`, X, CMP, ids)
}

#' @name CorMatrix
#' @aliases CorMatrix,FastWilcoxTest-method
#' @rdname CorMatrix-methods
#' @docType methods
#' @description simply calculate the correlation between X and Y
#' approximately 3x faster than an apply using the R cor function on sparse data
#' @param X the sparse matrix
#' @param CMP the vector to correlate every column of the matrix to
#' @title Calculate correlation over two double vectors
#' @export
CorMatrix <- function(X, CMP) {
    .Call(`_FastWilcoxTest_CorMatrix`, X, CMP)
}

#' @title logFC calculates a log fold change between the two input vectors
#' @aliases logFC,FastWilcoxTest-method
#' @rdname logFC
#' @description a simple replacement of wilcox.test returning less information but >10x faster
#' @param A one numeric vector of log data
#' @param B the other log vector
#' @return a double fold change
#' @export
logFC <- function(A, B) {
    .Call(`_FastWilcoxTest_logFC`, A, B)
}

minusOne <- function(X) {
    .Call(`_FastWilcoxTest_minusOne`, X)
}

plusOne <- function(X) {
    .Call(`_FastWilcoxTest_plusOne`, X)
}

#' @title cppWilcoxTest runs wilcox test comparing x and y
#' @aliases cppWilcoxTest,cppWilcoxTest-method
#' @rdname cppWilcoxTest
#' @description a simple replacement of wilcox.test returning less information but >10x faster
#' @param x the interesting information
#' @param y the background information
#' @param type the test type (greater=0,less=1,twoSided=2,U=3,Abslog10greater=4,log10less=5,abslog10twoSided=6,Q=7)
#' @return a double vector with 2 entries : Rank sum and p.value,
#' @export
cppWilcoxTest <- function(x, y, type) {
    .Call(`_FastWilcoxTest_cppWilcoxTest`, x, y, type)
}

#' @title StatTest runs wilcox test on the columns of the sparse matrix
#' @aliases StatTest,FastWilcoxTest-method
#' @rdname StatTest
#' @description This test implements the Seurat FindMarkers( test.use == "wilcox" ) function
#' in the greatest possible way, but using Rcpp instead of R. So far I could get a ~10x speed improvement.
#' @param X the sparse matrix (tests are applied to columns!)
#' @param interest row IDs for the group of interest
#' @param background row IDS for the background
#' @param logFCcut data is meant to be log() transformed and only columns passing a logFCcut of (default 1) are tested
#' @param minPct only test genes that are detected in a minimum fraction of
#' minPct cells in either of the two populations. Meant to speed up the function
#' by not testing genes that are very infrequently expressed. Default is 0.1
#' @param onlyPos check only higher expression (default FALSE)
#' @return a matrix with tested column ids, logFC and p.value
#' @export
StatTest <- function(X, interest, background, logFCcut = 1.0, minPct = 0.1, onlyPos = FALSE) {
    .Call(`_FastWilcoxTest_StatTest`, X, interest, background, logFCcut, minPct, onlyPos)
}

#' @name ZScore
#' @aliases ZScore,FastWilcoxTest-method
#' @rdname ZScore-methods
#' @docType methods
#' @description A specific z. score method that converts the data to 10 +-1 instead of 0+-1
#' in order to keep the not expressed clearly separate from the real data.
#' @param data the sparse Matrix
#' @param display_progress show a progress bar (TRUE)
#' @title Calculate z score for a sparse matrix
#' @export
ZScore <- function(data, display_progress = TRUE) {
    .Call(`_FastWilcoxTest_ZScore`, data, display_progress)
}

#' @name collapse
#' @aliases collapse,FastWilcoxTest-method
#' @rdname collapse-methods
#' @docType methods
#' @description sums up the values for each ids type
#' @param X the sparse matrix
#' @param ids group ids (int vector from 1 10 maxgroup for each column)
#' @param type ( 0: logAdd; 1 : simple addition; 2: log Add -1 )
#' @title Calculate correlation over two double vectors
#' @export
collapse <- function(X, ids, type) {
    .Call(`_FastWilcoxTest_collapse`, X, ids, type)
}

# Register entry points for exported C++ functions
methods::setLoadAction(function(ns) {
    .Call('_FastWilcoxTest_RcppExport_registerCCallable', PACKAGE = 'FastWilcoxTest')
})
